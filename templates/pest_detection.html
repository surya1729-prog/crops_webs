<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaf & Pest Analyzer (Dummy)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for a clean look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fc;
        }
        /* Custom spinner animation */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .spinner {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-4xl bg-white shadow-2xl rounded-xl p-6 md:p-10 border border-gray-100">

        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-extrabold text-green-700 tracking-tight">
                ðŸŒ¿ Plant Health Analyzer
            </h1>
            <p class="text-gray-500 mt-2 text-lg">Upload a leaf image for instant (simulated) diagnosis.</p>
        </header>

        <!-- Main Content Grid -->
        <div class="grid md:grid-cols-2 gap-8">

            <!-- 1. Upload & Display Area -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">1. Upload Leaf Image</h2>
                
                <!-- File Input Card -->
                <div class="border-2 border-dashed border-green-300 rounded-lg p-6 text-center cursor-pointer hover:border-green-500 transition duration-300" 
                     id="upload-area" onclick="document.getElementById('file-input').click()">
                    
                    <!-- SVG Icon (Leaf) -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto mb-3 text-green-500">
                        <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 21 2 21 2s-5.5 5.5-5 10.2A7 7 0 0 1 11 20"/>
                        <path d="M9.8 6.1C5.5 5 2 2 2 2s3.5 3.5 2.2 7.8A7 7 0 0 1 9.8 6.1"/>
                    </svg>

                    <p class="text-gray-600 font-medium">Click to select an image or drag and drop</p>
                    <p class="text-sm text-gray-400 mt-1">PNG, JPG, or JPEG (Max 5MB)</p>
                    
                    <input type="file" id="file-input" class="hidden" accept="image/*">
                </div>
                
                <!-- Image Preview -->
                <div id="preview-container" class="mt-6 hidden">
                    <h3 class="text-xl font-medium text-gray-700 mb-3">Preview:</h3>
                    <img id="image-preview" class="w-full h-64 object-cover rounded-lg shadow-md border border-gray-200" alt="Selected Leaf Image">
                </div>

                <!-- Analyze Button -->
                <button id="analyze-button" 
                        class="mt-6 w-full py-3 bg-green-600 text-white font-bold rounded-lg shadow-lg hover:bg-green-700 transition duration-300 disabled:opacity-50 flex items-center justify-center" 
                        disabled>
                    <span id="button-text">Analyze Leaf Health (Simulated)</span>
                    <svg id="spinner" class="spinner h-5 w-5 text-white ml-2 hidden" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 4V2M12 22V20M4 12H2M22 12H20M19.78 4.22L18.36 5.64M5.64 18.36L4.22 19.78M19.78 19.78L18.36 18.36M5.64 5.64L4.22 4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <!-- New Reset Button -->
                <button id="reset-button" 
                        class="mt-3 w-full py-3 bg-gray-300 text-gray-800 font-bold rounded-lg hover:bg-gray-400 transition duration-300" 
                        onclick="resetApp()">
                    Start New Diagnosis
                </button>
            </div>

            <!-- 2. Results Area -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">2. Prediction Results</h2>

                <!-- Results Card (Initially empty/placeholder) -->
                <div id="results-card" class="bg-gray-50 border border-gray-200 p-6 rounded-lg shadow-inner min-h-[300px] flex items-center justify-center">
                    <p id="placeholder-text" class="text-gray-400 text-center">
                        Upload an image and click 'Analyze' to see the mock results here.
                    </p>
                    
                    <!-- Content will be injected here -->
                </div>
            </div>
        </div>

    </div>

    <script>
        const fileInput = document.getElementById('file-input');
        const imagePreview = document.getElementById('image-preview');
        const previewContainer = document.getElementById('preview-container');
        const analyzeButton = document.getElementById('analyze-button');
        const resultsCard = document.getElementById('results-card');
        const placeholderText = document.getElementById('placeholder-text');
        const buttonText = document.getElementById('button-text');
        const spinner = document.getElementById('spinner');

        // --- Mock Prediction Data (Updated to Array for Randomness) ---
        const mockResults = [
            {
                disease: 'Healthy Leaf',
                confidence: '99.9%',
                severity: 'None',
                recommendation: 'The plant appears healthy! Continue with standard watering and nutrient schedules. Monitor for early signs of stress and ensure good airflow.',
                color: 'bg-green-100 border-green-500 text-green-800'
            },
            {
                disease: 'Tomato Leaf Mold (Passalora fulva)',
                confidence: '98.5%',
                severity: 'High',
                recommendation: 'Isolate the plant immediately, ensure excellent air circulation (prune lower leaves), and apply a copper-based fungicide to stop the spread. Avoid watering the leaves.',
                color: 'bg-red-100 border-red-500 text-red-800'
            },
            {
                disease: 'Spider Mites Infestation (Tetranychus urticae)',
                confidence: '92.1%',
                severity: 'High',
                recommendation: 'Use a strong jet of water to dislodge the mites. Apply neem oil or insecticidal soap every 5-7 days for several weeks. Increase humidity around the plant.',
                color: 'bg-red-100 border-red-500 text-red-800'
            },
            {
                disease: 'Early Blight (Alternaria solani)',
                confidence: '85.4%',
                severity: 'Medium',
                recommendation: 'Remove and destroy affected leaves. Apply a registered fungicide (e.g., chlorothalonil). Ensure proper crop rotation next season and improve soil drainage.',
                color: 'bg-orange-100 border-orange-500 text-orange-800'
            },
            {
                disease: 'Nutrient Deficiency (Nitrogen)',
                confidence: '78.0%',
                severity: 'Low',
                recommendation: 'The lower leaves are yellowing. Apply a balanced fertilizer high in nitrogen immediately. Consider a slow-release granular fertilizer for sustained feeding.',
                color: 'bg-blue-100 border-blue-500 text-blue-800'
            }
        ];
        
        // --- Reset Function (New Feature) ---
        function resetApp() {
            // Clear the file input element's value
            fileInput.value = ''; 
            
            // Clear the image preview
            imagePreview.src = '';
            previewContainer.classList.add('hidden');
            
            // Reset the results card to placeholder
            resultsCard.innerHTML = `
                <p id="placeholder-text" class="text-gray-400 text-center">
                    Upload an image and click 'Analyze' to see the mock results here.
                </p>
            `;
            
            // Reset the analyze button
            analyzeButton.disabled = true;
            buttonText.textContent = 'Analyze Leaf Health (Simulated)';
            spinner.classList.add('hidden');
        }

        // Make resetApp globally accessible since it's called from HTML onclick
        window.resetApp = resetApp;

        // --- Event Listener for File Input ---
        fileInput.addEventListener('change', function(event) {
            const file = event.target.files[0];

            // Use the new reset function to ensure a clean slate
            // We call resetApp here to clear results/state if a new file is chosen
            // before the old one was analyzed, but keep the button disabled until the file loads.
            resetApp(); 

            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    previewContainer.classList.remove('hidden');
                    analyzeButton.disabled = false;
                }
                reader.readAsDataURL(file);
            } else {
                imagePreview.src = '';
                previewContainer.classList.add('hidden');
                analyzeButton.disabled = true;
            }
        });

        // --- Event Listener for Analyze Button (Updated to select random result) ---
        analyzeButton.addEventListener('click', function() {
            // 1. Start loading state
            analyzeButton.disabled = true;
            buttonText.textContent = 'Analyzing...';
            spinner.classList.remove('hidden');
            resultsCard.innerHTML = `
                <div class="flex flex-col items-center">
                    <svg class="spinner h-10 w-10 text-green-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 4V2M12 22V20M4 12H2M22 12H20M19.78 4.22L18.36 5.64M5.64 18.36L4.22 19.78M19.78 19.78L18.36 18.36M5.64 5.64L4.22 4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <p class="mt-3 text-lg text-green-600">Simulating deep learning analysis...</p>
                </div>
            `;

            // 2. Simulate API delay
            setTimeout(() => {
                // Select a random mock result from the array
                const randomIndex = Math.floor(Math.random() * mockResults.length);
                const selectedResult = mockResults[randomIndex];

                // 3. End loading state
                analyzeButton.disabled = false;
                buttonText.textContent = 'Analyze Leaf Health (Simulated)';
                spinner.classList.add('hidden');

                // 4. Inject mock results
                injectResults(selectedResult);

            }, 2500); // 2.5 second delay
        });

        // --- Function to inject the mock results into the card ---
        function injectResults(result) {
            // Determine border color based on result color class
            let borderColor = 'border-green-700'; 
            if (result.color.includes('red')) {
                borderColor = 'border-red-700';
            } else if (result.color.includes('orange')) {
                borderColor = 'border-orange-700';
            } else if (result.color.includes('blue')) {
                borderColor = 'border-blue-700';
            }
            // Use the determined border color in the injected HTML
            resultsCard.innerHTML = `
                <div class="w-full text-left p-0">
                    <div class="${result.color} p-4 rounded-t-lg border-b-4 ${borderColor}">
                        <p class="text-sm font-semibold uppercase tracking-wider">Prediction Confidence</p>
                        <h3 class="text-4xl font-extrabold mt-1">${result.confidence}</h3>
                    </div>

                    <div class="p-6">
                        <h4 class="text-2xl font-bold text-gray-800 mb-3 flex items-center">
                            Detected Issue:
                        </h4>
                        <!-- Using the result color class for background and border -->
                        <div class="${result.color.replace('-100', '-50')} p-3 rounded-md mb-4 border-l-4 ${borderColor}">
                            <p class="font-bold text-lg ${result.color.includes('text-') ? result.color.split(' ').find(c => c.startsWith('text-')) : 'text-gray-800'}">${result.disease}</p>
                            <p class="text-sm ${result.color.includes('text-') ? result.color.split(' ').find(c => c.startsWith('text-')) : 'text-gray-700'}">Severity: <span class="font-semibold">${result.severity}</span></p>
                        </div>
                        

                        <h4 class="text-xl font-semibold text-gray-800 mt-5 mb-2">Recommended Action:</h4>
                        <p class="text-gray-700 leading-relaxed">${result.recommendation}</p>
                        
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <p class="text-xs text-gray-500 italic">
                                Note: This is a dummy output for demonstration purposes. Results are randomized.
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
